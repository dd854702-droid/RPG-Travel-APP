<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÂêçÂè§Â±ãÂÜíÈö™Êó•Ë™å | Nagoya Adventure Log</title>
    
    <!-- 1. ËºâÂÖ• Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- 3. Ë®≠ÂÆö Import Map -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>

    <!-- 4. ËºâÂÖ• Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* È¢®Ê†ºË®≠ÂÆö */
        :root {
            --bg-dark: #0f172a;
            --text-main: #e2e8f0;
            --accent-gold: #fbbf24;
            --accent-blue: #60a5fa;
            --accent-red: #f87171;
        }
        body { 
            background-color: var(--bg-dark); 
            color: var(--text-main); 
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* ÂãïÁï´ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-enter { animation: fadeIn 0.3s ease-out forwards; }
        
        /* ÈúìËôπÂÖâÊöàÊïàÊûú */
        .glow-text { text-shadow: 0 0 10px rgba(251, 191, 36, 0.5); }
        .glow-border { box-shadow: 0 0 8px rgba(96, 165, 250, 0.6); }

        /* ÂúìÈ§ÖÂúñÊ®£Âºè */
        .pie-chart {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--pie-gradient));
            position: relative;
        }
        .pie-chart::after {
            content: "";
            position: absolute;
            inset: 40px; /* ÁîúÁîúÂúàÂ§ßÂ∞è */
            background: #1e293b; /* bg-slate-800 */
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Plane, Train, MapPin, Coffee, Utensils, ShoppingBag, Home, Footprints, Camera, ArrowDown, 
            Coins, BookOpen, Scroll, Info, Shield, Zap, Cloud, Calendar, CheckSquare, X, ZoomIn, PlusCircle,
            Edit, Trash2, Globe, Shirt, RefreshCw, Loader2, Phone, Siren, AlertTriangle, ExternalLink, Thermometer,
            TrendingUp, Save, Clock, Map, PieChart, Volume2, Image as ImageIcon, Navigation, Timer, Bus, Car, Ticket
        } from 'lucide-react';

        // --- Icon Map for Dynamic Rendering ---
        const ICON_MAP = {
            Plane, Train, MapPin, Coffee, Utensils, ShoppingBag, Home, Footprints, Camera, ArrowDown,
            Coins, BookOpen, Scroll, Info, Shield, Zap, Cloud, Calendar, CheckSquare, X, ZoomIn, PlusCircle,
            Edit, Trash2, Globe, Shirt, RefreshCw, Loader2, Phone, Siren, AlertTriangle, ExternalLink,
            Save, Clock, Map, PieChart, Volume2, ImageIcon, Navigation, Timer, Bus, Car, Ticket
        };

        // --- Static Data (Default State) ---

        const SPELL_DATA = [
            { icon: "üßÖ", title: "È©ÖÈô§Ëî•Ëä±", jp: "„Éç„ÇÆÊäú„Åç„Åß„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", zh: "Ë´ã‰∏çË¶ÅÂä†Ëî•", type: "defense" },
            { icon: "üßä", title: "ÂéªÂÜ∞Âíí", jp: "Ê∞∑„Å™„Åó„Åß„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", zh: "Ë´ãÂéªÂÜ∞", type: "support" },
            { icon: "üíß", title: "Âè¨ÂñöÊ∞¥", jp: "„ÅäÊ∞¥„Åè„Å†„Åï„ÅÑ", zh: "Ë´ãÁµ¶ÊàëÊ∞¥", type: "support" },
            { icon: "üöª", title: "Â∞ãÊâæÂØÜÂÆ§", jp: "„Éà„Ç§„É¨„ÅØ„Å©„Åì„Åß„Åô„ÅãÔºü", zh: "ÂªÅÊâÄÂú®Âì™Ë£°", type: "exploration" },
            { icon: "üßæ", title: "ÁµêÁÆóÂç∑Ëª∏", jp: "„Åä‰ºöË®à„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", zh: "Ë´ãÁµêÂ∏≥", type: "interaction" },
            { icon: "üì∏", title: "ÊîùÈ≠ÇË°ì", jp: "ÂÜôÁúü„ÇíÊíÆ„Å£„Å¶„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„ÅãÔºü", zh: "ÂèØ‰ª•ÊãçÁÖßÂóéÔºü", type: "interaction" },
            { icon: "üôè", title: "Á•àÊ±ÇË°ì", jp: "„Åì„Çå„Çí„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", zh: "ÊàëË¶ÅÈÄôÂÄã (ÊåáËèúÂñÆ)", type: "interaction" },
            { icon: "ü•°", title: "Â∏∂Ëµ∞Ë°ì", jp: "ÊåÅ„Å°Â∏∞„Çä„Åß„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", zh: "Ë´ãÂπ´ÊàëÂ§ñÂ∏∂", type: "support" },
        ];

        const INITIAL_CHECKLIST = [
            { id: 1, text: "Ë≠∑ÁÖß (ÈÄöË°åË≠â)", checked: false },
            { id: 2, text: "Á∂≤Âç°/Êº´ÈÅä (ÈÄöË®äÊ∞¥Êô∂)", checked: false },
            { id: 3, text: "Êó•Âπ£ÁèæÈáë (ÈáëÂπ£)", checked: false },
            { id: 4, text: "Ë°åÂãïÈõªÊ∫ê (È≠îÂäõÊ∫ê)", checked: false },
            { id: 5, text: "Â∏∏Áî®Ëó•ÂìÅ (ÂõûÂæ©Ëó•)", checked: false },
            { id: 6, text: "Visit Japan WebÊà™Âúñ", checked: false },
        ];

        // Refactored QUEST_DATA with Transport Mode (icon string)
        const INITIAL_QUEST_DATA = [
            {
                day: 0,
                title: "Â∫èÁ´†: ÈôçËêΩËàáÊΩõÂÖ•",
                date: "2026-03-02",
                stats: { xp: "500 XP", gold: 0, fatigue: "30%" }, 
                events: [
                { id: 'e0', time: "16:45", icon: "Plane", title: "ÂïüÁ®ã: Ê°ÉÂúíÊ©üÂ†¥", desc: "Êê≠‰πòËôéËà™ IT778 È£õÂæÄÂêçÂè§Â±ã (16:45-20:25)", type: "start", transportTime: "", transportCost: 0, transportMode: "" },
                { id: 'e1', time: "20:25", icon: "MapPin", title: "ÊäµÈÅîÊñ∞Âú∞Âúñ", desc: "IT778 ÈôçËêΩ‰∏≠ÈÉ®ÂúãÈöõÊ©üÂ†¥ (NGO) T2", type: "checkpoint", transportTime: "3h 40m", transportCost: 0, transportMode: "Plane" },
                { id: 'e2', time: "21:15", icon: "Footprints", title: "Á©øË∂äÈÄöÈÅì", desc: "Ê≠•Ë°åËá≥‰∫§ÈÄöÂª£Â†¥ (T1ÊñπÂêë)", type: "move", transportTime: "15m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e3', time: "21:37", icon: "Train", title: "Êê≠‰πòÂêçÈêµÁâπÊÄ•", desc: "ÂæÄÂêçÂè§Â±ã/Â≤êÈòúÊñπÂêë (Œº-SKYÈúÄË™≤Èáë)", type: "travel", transportTime: "10m", transportCost: 1250, transportMode: "Train" },
                { id: 'e4', time: "22:08", icon: "MapPin", title: "ÊäµÈÅîÈáëÂ±±Á´ô", desc: "ÈóúÈçµËΩâ‰πòÈªû (ÂãøÈÅéÁ´ô)", type: "checkpoint", transportTime: "31m", transportCost: 0, transportMode: "Train" },
                { id: 'e5', time: "22:23", icon: "Train", title: "ËΩâ‰πòÂú∞‰∏ãÈêµ", desc: "ÂêçÂüéÁ∑ö (Âè≥Áí∞) ÂæÄÊ¶ÆÊñπÂêë", type: "travel", transportTime: "15m", transportCost: 210, transportMode: "Train" },
                { id: 'e6', time: "22:40", icon: "Home", title: "Â≠òÊ™îÈªû: Trip & Sleep", desc: "Ëæ¶ÁêÜÂÖ•‰Ωè Trip & Sleep hostelÔºå‰ºëÊÅØÂõûË°Ä", type: "save", transportTime: "10m", transportCost: 0, transportMode: "Footprints" },
                ]
            },
            {
                day: 1,
                title: "Á¨¨‰∏ÄÁ´†: Â∏ÇÂ†¥ËàáÁ•ûÊÆø",
                date: "2026-03-03",
                stats: { xp: "1200 XP", gold: 0, fatigue: "60%" },
                events: [
                { id: 'e11', time: "08:00", icon: "Home", title: "ÂÜíÈö™ÈñãÂßã", desc: "Âæû Trip & Sleep hostel Âá∫Áôº", type: "start", transportTime: "", transportCost: 0, transportMode: "" },
                { id: 'e12', time: "08:45", icon: "Utensils", title: "Êü≥Ê©ã‰∏≠Â§ÆÂ∏ÇÂ†¥", desc: "Ë£úÁµ¶: ÁîüÈ≠öÁâá„ÄÅÊµ∑ÈÆÆÂ∑°Á¶Æ", type: "loot", transportTime: "30m", transportCost: 210, transportMode: "Train" },
                { id: 'e13', time: "12:00", icon: "Utensils", title: "ÂçàÈ§ê: È≥•ÈñãÁ∑èÊú¨ÂÆ∂", desc: "Áç≤ÂæóÁâ©ÂìÅ: ÈáëË≥ûË¶™Â≠ê‰∏º", type: "loot", transportTime: "15m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e14', time: "13:30", icon: "ShoppingBag", title: "Â§ßÈ†àÂïÜÂ∫óË°ó", desc: "‰∫§ÊòìËàáÊé¢Á¥¢ (Á¥Ñ2Â∞èÊôÇ)", type: "action", transportTime: "20m", transportCost: 210, transportMode: "Train" },
                { id: 'e15', time: "15:30", icon: "Coffee", title: "‰∏ãÂçàËå∂: Konparu", desc: "Ë£úÁµ¶: ÁÇ∏Ëù¶‰∏âÊòéÊ≤ª", type: "heal", transportTime: "5m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e16', time: "18:30", icon: "Utensils", title: "ÊôöÈ§ê: ÁÜ±Áî∞Ëì¨ËêäËªí", desc: "ÊåëÊà∞ÂÇ≥Ë™™ÁæéÈ£ü: È∞ªÈ≠öÈ£Ø‰∏âÂêÉ", type: "boss", transportTime: "30m", transportCost: 270, transportMode: "Train" },
                { id: 'e17', time: "20:30", icon: "Home", title: "ËøîÂõûÊìöÈªû", desc: "ÂõûÂà∞ Trip & Sleep hostel ‰ºëÊÅØ", type: "save", transportTime: "40m", transportCost: 270, transportMode: "Train" },
                ]
            },
            {
                day: 2,
                title: "Á¨¨‰∫åÁ´†: Âè§ÂüéËàáÂíñÂï°",
                date: "2026-03-04",
                stats: { xp: "1500 XP", gold: 0, fatigue: "75%" },
                events: [
                { id: 'e20', time: "07:45", icon: "Home", title: "Êó©ÂÆâÂêçÂè§Â±ã", desc: "Âæû Trip & Sleep hostel Âá∫Áôº", type: "start", transportTime: "", transportCost: 0, transportMode: "" },
                { id: 'e21', time: "08:00", icon: "Coffee", title: "Êó©È§ê: Bucyo Coffee", desc: "Ë£úÁµ¶: Â∞èÂÄâÁ¥ÖË±ÜÂêêÂè∏", type: "heal", transportTime: "15m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e22', time: "10:00", icon: "MapPin", title: "Áä¨Â±±ÂüéÊîªÁï•", desc: "ÂúãÂØ∂Â§©ÂÆàÈñ£ (ÈñÄÁ•® ¬•550)", type: "dungeon", transportTime: "50m", transportCost: 600, transportMode: "Train" },
                { id: 'e23', time: "12:30", icon: "Utensils", title: "ÂçàÈ§ê: Sakura Chaya", desc: "Áç≤ÂæóÁâ©ÂìÅ: Áî∞Ê®ÇÁÉ§Ë±ÜËÖê‰∏≤", type: "loot", transportTime: "10m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e24', time: "15:00", icon: "Coffee", title: "GOLPIE COFFEE", desc: "Â∑ùÂêçÂ±±ÂÜ†ËªçÂíñÂï°Â∑°Á¶Æ", type: "action", transportTime: "1h 20m", transportCost: 800, transportMode: "Train" },
                { id: 'e25', time: "18:00", icon: "Utensils", title: "Solo Pizza", desc: "Â§ßÈ†àÊú¨Â∫ó (‰∏ñÁïåÂÜ†ËªçÊä´Ëñ©)", type: "loot", transportTime: "30m", transportCost: 240, transportMode: "Train" },
                { id: 'e26', time: "20:00", icon: "Home", title: "ËøîÂõûÊìöÈªû", desc: "ÂõûÂà∞ Trip & Sleep hostel ‰ºëÊÅØ", type: "save", transportTime: "15m", transportCost: 0, transportMode: "Footprints" },
                ]
            },
            {
                day: 3,
                title: "Á¨¨‰∏âÁ´†: Â∞áËªçÁöÑÊ¶ÆËÄÄ",
                date: "2026-03-05",
                stats: { xp: "1800 XP", gold: 0, fatigue: "85%" },
                events: [
                { id: 'e30', time: "07:45", icon: "Home", title: "Êó©ÂÆâÂêçÂè§Â±ã", desc: "Âæû Trip & Sleep hostel Âá∫Áôº", type: "start", transportTime: "", transportCost: 0, transportMode: "" },
                { id: 'e31', time: "08:00", icon: "Coffee", title: "Êó©È§ê: Karasu", desc: "Â≠§Áç®ÁöÑÁæéÈ£üÂÆ∂ÂíñÂï°Âª≥", type: "heal", transportTime: "15m", transportCost: 210, transportMode: "Train" },
                { id: 'e32', time: "09:30", icon: "MapPin", title: "ÂêçÂè§Â±ãÂüé", desc: "ÈáëÈØ±ËàáÊú¨‰∏∏Âæ°ÊÆø (ÈñÄÁ•® ¬•500)", type: "dungeon", transportTime: "20m", transportCost: 210, transportMode: "Bus" },
                { id: 'e33', time: "11:30", icon: "Camera", title: "Âæ∑Â∑ùÂúí", desc: "Êó•ÂºèÂ∫≠ÂúíÊï£Ê≠• (ÈñÄÁ•® ¬•300)", type: "action", transportTime: "30m", transportCost: 210, transportMode: "Bus" },
                { id: 'e34', time: "13:00", icon: "Utensils", title: "ÂçàÈ§ê: Yellow", desc: "ÂâáÊ≠¶Êñ∞Áî∫ ÊøÉÂéöÊ≠êÂßÜËõãÂåÖÈ£Ø", type: "loot", transportTime: "30m", transportCost: 210, transportMode: "Bus" },
                { id: 'e35', time: "15:00", icon: "ShoppingBag", title: "Ê¶Æ (Sakae)", desc: "LACHIC, ‰∏≠Êó•Â§ßÊ®ì Ë≥ºÁâ©", type: "trade", transportTime: "20m", transportCost: 210, transportMode: "Train" },
                { id: 'e36', time: "18:00", icon: "Utensils", title: "ÊôöÈ§ê: Êµ∑ËÄÅ„Å©„Å¶", desc: "ÊåëÊà∞: 35cm ÁâπÂ§ßÁÇ∏Ëù¶", type: "boss", transportTime: "10m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e37', time: "20:00", icon: "Home", title: "ËøîÂõûÊìöÈªû", desc: "ÂõûÂà∞ Trip & Sleep hostel ‰ºëÊÅØ", type: "save", transportTime: "15m", transportCost: 210, transportMode: "Train" },
                ]
            },
            {
                day: 4,
                title: "ÁµÇÁ´†: Ê≠∏ÈÄî",
                date: "2026-03-06",
                stats: { xp: "2000 XP", gold: 0, fatigue: "99%" },
                events: [
                { id: 'e41', time: "09:40", icon: "Home", title: "ÊóÖÂ∫óÈÄÄÊàø", desc: "ÂëäÂà• Trip & Sleep hostelÔºåÂâçÂæÄÊ©üÂ†¥", type: "start", transportTime: "", transportCost: 0, transportMode: "" },
                { id: 'e42', time: "09:50", icon: "Train", title: "Âú∞‰∏ãÈêµÁßªÂãï", desc: "‰∏äÂâçÊ¥• (M03) -> ÈáëÂ±± (M01)", type: "travel", transportTime: "10m", transportCost: 210, transportMode: "Train" },
                { id: 'e43', time: "10:18", icon: "Train", title: "ÂêçÈêµÁâπÊÄ• Œº-SKY", desc: "ÈáëÂ±±Á´ô -> ‰∏≠ÈÉ®ÂúãÈöõÊ©üÂ†¥", type: "travel", transportTime: "28m", transportCost: 1250, transportMode: "Train" },
                { id: 'e44', time: "10:50", icon: "MapPin", title: "ÊäµÈÅîÊ©üÂ†¥ T1", desc: "ÂâçÂæÄ‰∫§ÈÄöÂª£Â†¥", type: "checkpoint", transportTime: "5m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e45', time: "11:05", icon: "Footprints", title: "Ê≠•Ë°åËá≥ T2", desc: "Èï∑Ë∑ùÈõ¢ÁßªÂãï (10-15ÂàÜ)", type: "move", transportTime: "15m", transportCost: 0, transportMode: "Footprints" },
                { id: 'e46', time: "11:05", icon: "Plane", title: "Â†±Âà∞ & Ë®óÈÅã", desc: "ËôéËà™Ê´ÉÊ™Ø IT779 (13:15 Ëµ∑È£õ)", type: "action", transportTime: "0m", transportCost: 0, transportMode: "" },
                { id: 'e47', time: "13:15", icon: "Plane", title: "ËøîËà™: IT779", desc: "È£õÂæÄÊ°ÉÂúíÊ©üÂ†¥ (13:15-15:25)", type: "travel", transportTime: "", transportCost: 0, transportMode: "Plane" },
                { id: 'e48', time: "15:25", icon: "Home", title: "Mission Complete", desc: "ÊäµÈÅîÊ°ÉÂúíÊ©üÂ†¥Ôºå‰ªªÂãôÁµêÊùü", type: "end", transportTime: "3h 10m", transportCost: 0, transportMode: "Plane" },
                ]
            }
        ];

        const INITIAL_EXPENSES = [
            { id: 1, item: "Ê©üÁ•®È†ê‰ªò", cost: 12000, type: "travel", date: "2025-10-15" },
            { id: 2, item: "‰ΩèÂÆøÈ†êË®Ç", cost: 8000, type: "save", date: "2025-11-20" }
        ];

        // --- Custom Hook for LocalStorage ---
        function useStickyState(defaultValue, key) {
            const [value, setValue] = useState(() => {
                const stickyValue = window.localStorage.getItem(key);
                return stickyValue !== null ? JSON.parse(stickyValue) : defaultValue;
            });
            useEffect(() => {
                window.localStorage.setItem(key, JSON.stringify(value));
            }, [key, value]);
            return [value, setValue];
        }

        // --- Main Component ---

        const App = () => {
            const [activeTab, setActiveTab] = useState('quest'); 
            const [activeLevel, setActiveLevel] = useState(0); 
            const [exchangeRate, setExchangeRate] = useState(0.22);
            const [currentTime, setCurrentTime] = useState("");

            // --- Persistent State (LocalStorage) ---
            const [checklist, setChecklist] = useStickyState(INITIAL_CHECKLIST, 'nagoya_checklist_v1');
            const [expenses, setExpenses] = useStickyState(INITIAL_EXPENSES, 'nagoya_expenses_v1');
            const [budget, setBudget] = useStickyState(100000, 'nagoya_budget_v1');
            // UPDATED KEY to v5 for new transport mode data
            const [quests, setQuests] = useStickyState(INITIAL_QUEST_DATA, 'nagoya_quests_v5');

            // --- Modal & Input States ---
            const [isAddingEvent, setIsAddingEvent] = useState(false);
            const [newEventData, setNewEventData] = useState({
                time: "10:00",
                title: "",
                desc: "",
                type: "action",
                locationQuery: "",
                transportTime: "",
                transportCost: "",
                transportMode: "Footprints" // Default mode
            });

            const [editingId, setEditingId] = useState(null);
            const [newExpenseName, setNewExpenseName] = useState("");
            const [newExpenseCost, setNewExpenseCost] = useState("");
            const [newExpenseDate, setNewExpenseDate] = useState(new Date().toISOString().split('T')[0]);
            const [newExpenseType, setNewExpenseType] = useState('loot');

            const [transInput, setTransInput] = useState("");
            const [transResult, setTransResult] = useState("");
            const [isTranslating, setIsTranslating] = useState(false);
            const [selectedSpell, setSelectedSpell] = useState(null);
            const [countdown, setCountdown] = useState("");
            const [weatherTemp, setWeatherTemp] = useState(12);

            const fileInputRef = useRef(null);
            const [uploadingEventId, setUploadingEventId] = useState(null);

            const EXPENSE_TYPES = [
                { id: 'loot', label: 'ÁæéÈ£ü', color: 'bg-yellow-600 text-yellow-100', border: 'border-yellow-500' },
                { id: 'travel', label: '‰∫§ÈÄö', color: 'bg-blue-600 text-blue-100', border: 'border-blue-500' },
                { id: 'save', label: '‰ΩèÂÆø', color: 'bg-green-600 text-green-100', border: 'border-green-500' },
                { id: 'trade', label: 'Ë≥ºÁâ©', color: 'bg-pink-300 text-pink-900', border: 'border-pink-300' },
                { id: 'other', label: 'ÂÖ∂‰ªñ', color: 'bg-slate-600 text-slate-100', border: 'border-slate-500' },
            ];

            const TRANSPORT_MODES = [
                { id: 'Footprints', icon: Footprints, label: 'Ê≠•Ë°å' },
                { id: 'Train', icon: Train, label: 'ÈõªËªä' },
                { id: 'Bus', icon: Bus, label: 'ÂÖ¨Ëªä' },
                { id: 'Car', icon: Car, label: 'ÈñãËªä' },
                { id: 'Plane', icon: Plane, label: 'È£õÊ©ü' },
            ];

            useEffect(() => {
                const targetDate = new Date('2026-03-02T16:45:00').getTime();
                const interval = setInterval(() => {
                    const now = new Date();
                    const nowTime = now.getTime();
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    setCurrentTime(`${hours}:${minutes}`);

                    const distance = targetDate - nowTime;
                    if (distance < 0) {
                        setCountdown("‰ªªÂãôÈÄ≤Ë°å‰∏≠");
                    } else {
                        const d = Math.floor(distance / (1000 * 60 * 60 * 24));
                        const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        setCountdown(`${d}Â§©${h}ÊôÇ`);
                    }
                }, 1000);
                
                fetch('https://api.exchangerate-api.com/v4/latest/JPY')
                .then(res => res.json())
                .then(data => {
                    if(data && data.rates && data.rates.TWD) setExchangeRate(data.rates.TWD);
                })
                .catch(err => console.log('Rate fetch failed'));

                return () => clearInterval(interval);
            }, []);

            // --- Feature Functions ---

            const speakJapanese = (text) => {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                window.speechSynthesis.speak(utterance);
            };

            const openDailyMap = (dayIndex) => {
                const dayEvents = quests[dayIndex].events;
                const locations = dayEvents
                    .map(e => e.locationQuery || e.title)
                    .filter(l => l && !l.includes("Ëá™Áî±") && !l.includes("Ê©ü"));
                
                if(locations.length < 2) {
                    alert("ÊôØÈªû‰∏çË∂≥‰ª•Âª∫Á´ãË∑ØÁ∑ö (Ëá≥Â∞ëÈúÄË¶Å2ÂÄãÂú∞Èªû)");
                    return;
                }

                const origin = encodeURIComponent(locations[0]);
                const destination = encodeURIComponent(locations[locations.length - 1]);
                const waypoints = locations.slice(1, -1).map(l => encodeURIComponent(l)).join('/');
                
                const url = `https://www.google.com/maps/dir/${origin}/${waypoints}/${destination}`;
                window.open(url, '_blank');
            };

            const triggerImageUpload = (eventId) => {
                setUploadingEventId(eventId);
                fileInputRef.current.click();
            };

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (!file || !uploadingEventId) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const maxWidth = 800;
                        const scale = maxWidth / img.width;
                        const width = Math.min(img.width, maxWidth);
                        const height = img.height * (width / img.width);
                        
                        canvas.width = width;
                        canvas.height = height;
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const base64 = canvas.toDataURL('image/jpeg', 0.6);
                        
                        const newQuests = [...quests];
                        const dayEvents = newQuests[activeLevel].events;
                        const eventIdx = dayEvents.findIndex(e => e.id === uploadingEventId);
                        if(eventIdx > -1) {
                            dayEvents[eventIdx].image = base64;
                            setQuests(newQuests);
                        }
                    }
                    img.src = event.target.result;
                }
                reader.readAsDataURL(file);
                e.target.value = '';
            };

            const getExpenseStats = () => {
                const stats = { travel: 0, save: 0, loot: 0, trade: 0, other: 0 };
                let total = 0;
                expenses.forEach(e => {
                    const cost = Math.abs(e.cost);
                    total += cost;
                    if(e.type === 'travel') stats.travel += cost;
                    else if(e.type === 'save') stats.save += cost;
                    else if(e.type === 'loot') stats.loot += cost;
                    else if(e.type === 'trade') stats.trade += cost;
                    else stats.other += cost;
                });
                
                const pTravel = (stats.travel / total) * 100 || 0;
                const pSave = (stats.save / total) * 100 || 0;
                const pLoot = (stats.loot / total) * 100 || 0;
                const pTrade = (stats.trade / total) * 100 || 0;
                
                const gradient = `
                    #3b82f6 0% ${pTravel}%, 
                    #22c55e ${pTravel}% ${pTravel + pSave}%, 
                    #eab308 ${pTravel + pSave}% ${pTravel + pSave + pLoot}%, 
                    #f9a8d4 ${pTravel + pSave + pLoot}% ${pTravel + pSave + pLoot + pTrade}%, 
                    #64748b ${pTravel + pSave + pLoot + pTrade}% 100%
                `;
                return { gradient, stats, total };
            };

            const deleteEvent = (dayIndex, eventId) => {
                if(!window.confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãË°åÁ®ãÂóéÔºü")) return;
                const newQuests = [...quests];
                newQuests[dayIndex].events = newQuests[dayIndex].events.filter(e => e.id !== eventId);
                setQuests(newQuests);
            };

            const openAddModal = () => {
                setNewEventData({
                    time: "10:00",
                    title: "",
                    desc: "",
                    type: "action",
                    locationQuery: "",
                    transportTime: "",
                    transportCost: "",
                    transportMode: "Footprints"
                });
                setIsAddingEvent(true);
            };

            const saveNewEvent = () => {
                if (!newEventData.title) {
                    alert("Ë´ãËº∏ÂÖ•Ë°åÁ®ãÊ®ôÈ°å");
                    return;
                }
                let iconName = "MapPin";
                switch(newEventData.type) {
                    case 'checkpoint': iconName = "MapPin"; break;
                    case 'move': iconName = "Footprints"; break;
                    case 'travel': iconName = "Train"; break;
                    case 'save': iconName = "Home"; break;
                    case 'start': iconName = "Home"; break;
                    case 'loot': iconName = "Utensils"; break;
                    case 'action': iconName = "Camera"; break;
                    case 'heal': iconName = "Coffee"; break;
                    case 'boss': iconName = "Utensils"; break;
                    case 'dungeon': iconName = "MapPin"; break;
                    case 'trade': iconName = "ShoppingBag"; break;
                    case 'end': iconName = "Plane"; break;
                }
                const newEvent = {
                    id: Date.now().toString(),
                    time: newEventData.time,
                    icon: iconName,
                    title: newEventData.title,
                    desc: newEventData.desc,
                    type: newEventData.type,
                    locationQuery: newEventData.locationQuery || newEventData.title,
                    transportTime: newEventData.transportTime,
                    transportCost: parseInt(newEventData.transportCost) || 0,
                    transportMode: newEventData.transportMode
                };
                const newQuests = [...quests];
                newQuests[activeLevel].events.push(newEvent);
                newQuests[activeLevel].events.sort((a, b) => a.time.localeCompare(b.time));
                setQuests(newQuests);
                setIsAddingEvent(false);
            };

            const getCurrentDayGold = useMemo(() => {
                const targetDate = quests[activeLevel].date;
                const dailyExpenses = expenses.filter(e => e.date === targetDate);
                return dailyExpenses.reduce((acc, curr) => acc + curr.cost, 0);
            }, [expenses, activeLevel, quests]);

            const getOutfitAdvice = (temp) => {
                if (temp <= 5) return "Ê•µÂØíÔºöÁôºÁÜ±Ë°£ + ÁæΩÁµ®Ë°£ + ÂúçÂ∑æÊâãÂ•ó";
                if (temp <= 12) return "ÂØíÂÜ∑ÔºöÂ§ßË°£ + ÊØõË°£ + ÂúçÂ∑æ (Ê¥ãËî•Âºè)";
                if (temp <= 20) return "Ê∂ºÁàΩÔºöËñÑÂ§ñÂ•ó + Èï∑Ë¢ñTÊÅ§";
                return "Ê∫´ÊöñÔºöÁü≠Ë¢ñ + ËñÑË•ØË°´";
            };

            const handleEdit = (expense) => {
                setEditingId(expense.id);
                setNewExpenseName(expense.item);
                setNewExpenseCost(expense.cost);
                setNewExpenseDate(expense.date || new Date().toISOString().split('T')[0]);
                setNewExpenseType(expense.type || 'loot');
            };

            const handleCancelEdit = () => {
                setEditingId(null);
                setNewExpenseName("");
                setNewExpenseCost("");
                setNewExpenseDate(new Date().toISOString().split('T')[0]);
                setNewExpenseType('loot');
            };

            const handleDelete = (id) => {
                if(window.confirm("Á¢∫ÂÆöË¶ÅÈä∑ÊØÄÈÄôÁ≠ÜÁ¥ÄÈåÑÂóéÔºü")) {
                setExpenses(expenses.filter(e => e.id !== id));
                }
            };

            const addOrUpdateExpense = () => {
                if (!newExpenseName || !newExpenseCost || !newExpenseDate) return;
                if (editingId) {
                setExpenses(expenses.map(e => 
                    e.id === editingId 
                    ? { ...e, item: newExpenseName, cost: parseInt(newExpenseCost), date: newExpenseDate, type: newExpenseType } 
                    : e
                ));
                handleCancelEdit();
                } else {
                setExpenses([
                    { id: Date.now(), item: newExpenseName, cost: parseInt(newExpenseCost), type: newExpenseType, date: newExpenseDate }, 
                    ...expenses
                ]);
                setNewExpenseName("");
                setNewExpenseCost("");
                }
            };

            const handleTranslate = async () => {
                if (!transInput) return;
                setIsTranslating(true);
                setTransResult("");
                try {
                const apiKey = ""; 
                if (!apiKey) {
                    setTransResult("ÈåØË™§ÔºöË´ãË®≠ÂÆö API Key");
                    setIsTranslating(false);
                    return;
                }
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`,
                    {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ 
                        parts: [{ 
                            text: `Translate Traditional Chinese to Japanese (Polite/Travel). Output ONLY Japanese. Input: "${transInput}"` 
                        }] 
                        }]
                    })
                    }
                );
                const data = await response.json();
                const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;
                if (resultText) setTransResult(resultText.trim());
                else setTransResult("Ë©†Âî±Â§±Êïó...");
                } catch (error) {
                console.error("Translation error:", error);
                setTransResult("È≠îÂäõ‰∏çË∂≥ (API Error)");
                } finally {
                setIsTranslating(false);
                }
            };

            const toggleCheck = (id) => {
                setChecklist(checklist.map(item => item.id === id ? { ...item, checked: !item.checked } : item));
            };

            const totalSpentJPY = useMemo(() => expenses.reduce((acc, curr) => acc + curr.cost, 0), [expenses]);
            const totalSpentTWD = Math.round(totalSpentJPY * exchangeRate); 
            const remainingGold = budget - totalSpentJPY;
            const expenseStats = getExpenseStats();

            const getEventStyle = (type) => {
                switch (type) {
                case 'boss': return "border-red-500 bg-red-900/20 text-red-200";
                case 'loot': return "border-yellow-500 bg-yellow-900/20 text-yellow-200";
                case 'dungeon': return "border-purple-500 bg-purple-900/20 text-purple-200";
                case 'save': return "border-green-500 bg-green-900/20 text-green-200";
                case 'travel': return "border-blue-500 bg-blue-900/20 text-blue-200";
                case 'trade': return "border-orange-500 bg-orange-900/20 text-orange-200";
                case 'move': return "border-slate-500 bg-slate-800/50 text-slate-300";
                case 'heal': return "border-teal-500 bg-teal-900/20 text-teal-200";
                default: return "border-slate-600 bg-slate-800/50 text-slate-300";
                }
            };

            // --- Sub-Views ---

            const QuestView = () => (
                <div className="animate-enter w-full pb-20">
                    <input type="file" ref={fileInputRef} onChange={handleImageUpload} accept="image/*" className="hidden" />

                    <div className="flex w-full overflow-x-auto gap-2 mb-6 pb-2 no-scrollbar px-1">
                        {quests.map((quest, index) => (
                        <button
                            key={index}
                            onClick={() => setActiveLevel(index)}
                            className={`flex-shrink-0 px-4 py-2 border-2 text-xs font-bold transition-all duration-200 whitespace-nowrap rounded-sm ${
                            activeLevel === index
                                ? "bg-blue-600 border-blue-400 text-white translate-y-1 shadow-[0_0_10px_rgba(37,99,235,0.5)]"
                                : "bg-slate-800 border-slate-600 text-slate-400 hover:bg-slate-700"
                            }`}
                        >
                            {index === 0 ? "Â∫èÁ´†" : index === 4 ? "ÁµÇÁ´†" : `Á¨¨ ${index} Á´†`}
                        </button>
                        ))}
                    </div>

                    <div className="w-full bg-slate-800 border-2 border-slate-600 p-4 mb-6 rounded-sm relative overflow-hidden">
                        <div className="absolute top-0 right-0 p-1 bg-yellow-600 text-[10px] text-black font-bold font-mono px-2">CURRENT QUEST</div>
                        <div className="flex justify-between items-start">
                            <h2 className="text-xl font-bold text-green-400 mb-1">{quests[activeLevel].title}</h2>
                            <button onClick={() => openDailyMap(activeLevel)} className="text-xs bg-blue-900 text-blue-200 px-2 py-1 rounded border border-blue-500 flex items-center gap-1 hover:bg-blue-800 transition">
                                <Navigation size={12} /> Ë∑ØÁ∑öÂúñ
                            </button>
                        </div>
                        
                        <div className="text-sm text-slate-400 mb-4 flex justify-between items-center">
                            <span className="flex items-center gap-1"><Calendar size={12}/> {quests[activeLevel].date}</span>
                            <span className="text-blue-400 font-mono text-xs border border-blue-900 bg-blue-900/30 px-2 py-0.5 rounded">
                                T-{countdown}
                            </span>
                        </div>
                        
                        <div className="grid grid-cols-3 gap-2 text-xs border-t border-slate-700 pt-3">
                            <div className="text-center">
                                <div className="text-slate-500 mb-1">Áç≤ÂæóÁ∂ìÈ©ó</div>
                                <div className="text-purple-400 font-mono">{quests[activeLevel].stats.xp}</div>
                            </div>
                            <div className="text-center border-l border-slate-700">
                                <div className="text-slate-500 mb-1">Êú¨Á´†ÊîØÂá∫</div>
                                <div className="text-yellow-400 font-mono">
                                    {getCurrentDayGold > 0 ? `-¬•${getCurrentDayGold.toLocaleString()}` : "¬•0"}
                                </div>
                            </div>
                            <div className="text-center border-l border-slate-700">
                                <div className="text-slate-500 mb-1">Áñ≤ÂãûÂ∫¶</div>
                                <div className="text-red-400 font-mono">{quests[activeLevel].stats.fatigue}</div>
                            </div>
                        </div>
                    </div>

                    <div className="w-full relative pl-4">
                        <div className="absolute left-[27px] top-4 bottom-4 w-1 bg-slate-700 z-0"></div>
                        
                        {quests[activeLevel].events.map((event, idx) => {
                            const IconComponent = ICON_MAP[event.icon] || MapPin;
                            const isCurrent = event.time <= currentTime && (idx === quests[activeLevel].events.length - 1 || quests[activeLevel].events[idx+1].time > currentTime);
                            
                            // Determine Transport Icon
                            const TransportIcon = ICON_MAP[event.transportMode] || Footprints;

                            return (
                                <div key={event.id || idx} className="relative z-10 mb-6 group" >
                                    
                                    {/* Transport Info from Previous Node */}
                                    {(event.transportTime || event.transportCost > 0) && (
                                        <div className="flex items-center ml-[19px] mb-3 relative animate-in slide-in-from-left-2 duration-300">
                                            <div className="w-2 h-2 bg-slate-600 rounded-full border-2 border-slate-900 z-20"></div>
                                            <div className="ml-4 flex items-center gap-2 text-[10px] text-slate-400 bg-slate-900/90 px-2 py-1 rounded border border-slate-700 shadow-md">
                                                {/* Transport Mode Icon with Ticket Badge Logic */}
                                                <div className="relative mr-1">
                                                    <TransportIcon size={14} className={event.transportCost > 0 ? "text-yellow-100" : "text-slate-400"} />
                                                    {event.transportCost > 0 && (
                                                        <div className="absolute -top-1 -right-1 bg-yellow-600 text-slate-900 rounded-full p-[1px] border border-slate-900">
                                                            <Ticket size={6} />
                                                        </div>
                                                    )}
                                                </div>
                                                
                                                {event.transportTime && <span className="flex items-center gap-1"><Timer size={10} className="text-blue-400"/> {event.transportTime}</span>}
                                                {event.transportTime && event.transportCost > 0 && <span className="text-slate-600">|</span>}
                                                {event.transportCost > 0 && <span className="flex items-center gap-1 text-yellow-500"><Coins size={10}/> ¬•{event.transportCost}</span>}
                                            </div>
                                        </div>
                                    )}

                                    <div className="flex items-start">
                                        <div className={`w-12 h-12 flex-shrink-0 rounded-lg border-2 flex items-center justify-center bg-slate-900 shadow-lg z-10 ${
                                            event.type === 'boss' ? 'border-red-500 text-red-500' : 
                                            event.type === 'travel' ? 'border-blue-500 text-blue-500' :
                                            'border-slate-500 text-slate-400'
                                        } ${isCurrent ? 'glow-border' : ''}`}>
                                            <IconComponent className="w-5 h-5" />
                                        </div>
                                        <div className={`ml-4 flex-1 border-2 p-3 rounded-lg relative transition-transform ${getEventStyle(event.type)} ${isCurrent ? 'ring-2 ring-blue-400/50' : ''}`}>
                                            <div className={`absolute top-4 -left-2 w-3 h-3 border-l-2 border-b-2 bg-inherit transform rotate-45 ${
                                            event.type === 'boss' ? 'border-red-500 bg-slate-900' : 'border-inherit bg-slate-900'
                                            }`}></div>
                                            
                                            {isCurrent && (
                                                <div className="absolute -top-2 -right-2 bg-blue-600 text-white text-[10px] px-2 py-0.5 rounded font-bold animate-pulse shadow-lg z-20">
                                                    NOW
                                                </div>
                                            )}

                                            {event.image && (
                                                <div className="mb-3 rounded overflow-hidden border border-slate-600">
                                                    <img src={event.image} alt="Diary" className="w-full h-32 object-cover" />
                                                </div>
                                            )}

                                            <div className="absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <button onClick={() => triggerImageUpload(event.id)} className="text-slate-500 hover:text-blue-400 p-1">
                                                    <ImageIcon size={14} />
                                                </button>
                                                <button onClick={() => deleteEvent(activeLevel, event.id)} className="text-slate-500 hover:text-red-400 p-1">
                                                    <Trash2 size={14} />
                                                </button>
                                            </div>

                                            <div className="flex justify-between items-start mb-1 pr-6">
                                                {(event.locationQuery || event.title) ? (
                                                     <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(event.locationQuery || event.title)}`} target="_blank" className="font-bold text-sm tracking-wide hover:text-blue-300 flex items-center gap-1 border-b border-dashed border-slate-500/50 pb-0.5">
                                                        {event.title} <ExternalLink size={10} className="inline opacity-70"/>
                                                     </a>
                                                ) : (
                                                    <span className="font-bold text-sm tracking-wide">{event.title}</span>
                                                )}
                                                <span className="text-xs font-mono bg-black/30 px-1 rounded text-slate-200">{event.time}</span>
                                            </div>
                                            <p className="text-xs opacity-90 leading-relaxed text-slate-300">{event.desc}</p>
                                        </div>
                                    </div>
                                    {idx !== quests[activeLevel].events.length - 1 && (
                                    <div className="absolute left-[22px] -bottom-4 text-slate-600"><ArrowDown size={12} /></div>
                                    )}
                                </div>
                            );
                        })}

                        <div className="relative z-10 mt-4 mb-10 pl-16">
                            <button 
                                onClick={openAddModal}
                                className="w-full border-2 border-dashed border-slate-600 text-slate-500 rounded-lg p-3 hover:border-yellow-500 hover:text-yellow-400 transition flex items-center justify-center gap-2 group"
                            >
                                <PlusCircle className="group-hover:rotate-90 transition-transform" />
                                <span className="text-xs font-bold">Êñ∞Â¢ûË°åÁ®ã (ADD DATA)</span>
                            </button>
                        </div>
                        
                        <div className="flex items-center mt-8 mb-8 opacity-50">
                            <div className="w-3 h-3 bg-slate-600 rounded-full mx-auto relative right-2"></div>
                            <div className="text-xs text-slate-500 ml-4 font-mono">// LOG END</div>
                        </div>
                    </div>

                    {isAddingEvent && (
                        <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-enter">
                            <div className="bg-slate-900 border-2 border-yellow-600 w-full max-w-sm rounded-lg p-5 shadow-2xl relative max-h-[90vh] overflow-y-auto">
                                <button onClick={() => setIsAddingEvent(false)} className="absolute top-3 right-3 text-slate-500 hover:text-white"><X size={20}/></button>
                                <h3 className="text-yellow-500 font-bold mb-4 flex items-center gap-2">
                                    <Edit size={18} /> Êñ∞Â¢ûË°åÁ®ãÁØÄÈªû
                                </h3>
                                <div className="space-y-3">
                                    <div>
                                        <label className="text-[10px] text-slate-400 block mb-1">ÊôÇÈñì (TIME)</label>
                                        <div className="flex items-center bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                            <Clock size={14} className="text-slate-400 mr-2"/>
                                            <input type="time" value={newEventData.time} onChange={e => setNewEventData({...newEventData, time: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none font-mono"/>
                                        </div>
                                    </div>
                                    
                                    {/* Transport Info */}
                                    <div className="grid grid-cols-2 gap-2">
                                        <div>
                                            <label className="text-[10px] text-blue-400 block mb-1">ÂâçÁΩÆÁßªÂãïÊôÇÈñì (TRAVEL TIME)</label>
                                            <div className="flex items-center bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                                <Timer size={14} className="text-slate-400 mr-2"/>
                                                <input type="text" placeholder="‰æã: 15m" value={newEventData.transportTime} onChange={e => setNewEventData({...newEventData, transportTime: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none"/>
                                            </div>
                                        </div>
                                        <div>
                                            <label className="text-[10px] text-yellow-400 block mb-1">È†ê‰º∞Ë≤ªÁî® (EST. COST)</label>
                                            <div className="flex items-center bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                                <Coins size={14} className="text-slate-400 mr-2"/>
                                                <input type="number" placeholder="¬•" value={newEventData.transportCost} onChange={e => setNewEventData({...newEventData, transportCost: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none"/>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Transport Mode Selector */}
                                    <div>
                                        <label className="text-[10px] text-blue-300 block mb-1">‰∫§ÈÄöÊñπÂºè (MODE)</label>
                                        <div className="flex gap-2 overflow-x-auto pb-1 no-scrollbar">
                                            {TRANSPORT_MODES.map(mode => {
                                                const ModeIcon = mode.icon;
                                                return (
                                                    <button
                                                        key={mode.id}
                                                        onClick={() => setNewEventData({...newEventData, transportMode: mode.id})}
                                                        className={`flex flex-col items-center justify-center p-2 rounded border min-w-[50px] ${newEventData.transportMode === mode.id ? 'bg-blue-900 border-blue-500 text-blue-200' : 'bg-slate-800 border-slate-600 text-slate-500'}`}
                                                    >
                                                        <ModeIcon size={16} className="mb-1" />
                                                        <span className="text-[10px]">{mode.label}</span>
                                                    </button>
                                                )
                                            })}
                                        </div>
                                    </div>

                                    <div>
                                        <label className="text-[10px] text-slate-400 block mb-1">Ê®ôÈ°å / Âú∞Èªû (TITLE)</label>
                                        <div className="flex items-center bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                            <MapPin size={14} className="text-slate-400 mr-2"/>
                                            <input type="text" placeholder="‰æã: ÂêçÂè§Â±ãÂüé" value={newEventData.title} onChange={e => setNewEventData({...newEventData, title: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none"/>
                                        </div>
                                    </div>
                                     <div>
                                        <label className="text-[10px] text-slate-400 block mb-1">Ë™™Êòé (DESC)</label>
                                        <div className="bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                            <textarea rows="2" placeholder="Ë©≥Á¥∞Ë≥áË®ä..." value={newEventData.desc} onChange={e => setNewEventData({...newEventData, desc: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none resize-none"/>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="text-[10px] text-slate-400 block mb-1">È°ûÂûã (TYPE - Auto Icon)</label>
                                        <div className="grid grid-cols-3 gap-2">
                                            {[
                                                {id: 'checkpoint', label: 'ÊâìÂç°', color: 'border-slate-500'},
                                                {id: 'move', label: 'ÁßªÂãï', color: 'border-slate-500'},
                                                {id: 'travel', label: '‰∫§ÈÄö', color: 'border-blue-500 text-blue-400'},
                                                {id: 'loot', label: 'ÁæéÈ£ü', color: 'border-yellow-500 text-yellow-400'},
                                                {id: 'action', label: 'ÊôØÈªû', color: 'border-white'},
                                                {id: 'heal', label: '‰ºëÊÅØ', color: 'border-teal-500 text-teal-400'},
                                                {id: 'trade', label: 'Ë≥ºÁâ©', color: 'border-orange-500 text-orange-400'},
                                                {id: 'boss', label: 'Â§ßÈ§ê', color: 'border-red-500 text-red-400'},
                                                {id: 'save', label: '‰ΩèÂÆø', color: 'border-green-500 text-green-400'},
                                            ].map(t => (
                                                <button 
                                                    key={t.id}
                                                    onClick={() => setNewEventData({...newEventData, type: t.id})}
                                                    className={`text-xs py-2 rounded border ${newEventData.type === t.id ? `${t.color} bg-slate-800 font-bold` : 'border-slate-700 text-slate-500 bg-slate-900'}`}
                                                >
                                                    {t.label}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div>
                                        <label className="text-[10px] text-slate-400 block mb-1">Google Maps ÈóúÈçµÂ≠ó (ÈÅ∏Â°´)</label>
                                        <div className="flex items-center bg-slate-800 border border-slate-600 rounded px-3 py-2">
                                            <Map size={14} className="text-slate-400 mr-2"/>
                                            <input type="text" placeholder="Ëã•‰∏çÂêåÊñºÊ®ôÈ°åË´ãËº∏ÂÖ•..." value={newEventData.locationQuery} onChange={e => setNewEventData({...newEventData, locationQuery: e.target.value})} className="bg-transparent text-white text-sm w-full outline-none"/>
                                        </div>
                                    </div>
                                </div>
                                <button onClick={saveNewEvent} className="w-full mt-6 bg-yellow-600 hover:bg-yellow-500 text-black font-bold py-3 rounded flex items-center justify-center gap-2">
                                    <Save size={18}/> ÂØ´ÂÖ•Êó•Ë™å (SAVE)
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );

            // ... InventoryView, GrimoireView, InfoView same as before (omitted for brevity) ...
            
            // Re-adding InventoryView
            const InventoryView = () => (
                <div className="w-full animate-enter pb-32 relative min-h-[500px]">
                    <div className="bg-slate-800 border-2 border-yellow-600 p-4 mb-6 rounded-sm text-center shadow-[0_0_15px_rgba(234,179,8,0.15)] flex justify-between items-center">
                        <div className="text-left">
                            <div className="text-xs text-yellow-600 font-bold mb-1 tracking-widest">CURRENT GOLD</div>
                            <div className="text-3xl text-yellow-400 font-mono font-bold glow-text">¬•{remainingGold.toLocaleString()}</div>
                            <div className="text-[10px] text-slate-500 mt-1 font-mono">
                                <span>SPENT: ¬•{totalSpentJPY.toLocaleString()}</span>
                            </div>
                        </div>
                        <div className="pie-chart" style={{'--pie-gradient': expenseStats.gradient}}></div>
                    </div>

                    <div className="grid grid-cols-3 gap-2 mb-4 text-[10px] text-slate-400">
                        <div className="flex items-center gap-1"><div className="w-2 h-2 bg-blue-500 rounded-full"></div> ‰∫§ÈÄö: ¬•{expenseStats.stats.travel.toLocaleString()}</div>
                        <div className="flex items-center gap-1"><div className="w-2 h-2 bg-green-500 rounded-full"></div> ‰ΩèÂÆø: ¬•{expenseStats.stats.save.toLocaleString()}</div>
                        <div className="flex items-center gap-1"><div className="w-2 h-2 bg-yellow-500 rounded-full"></div> ÁæéÈ£ü: ¬•{expenseStats.stats.loot.toLocaleString()}</div>
                        <div className="flex items-center gap-1"><div className="w-2 h-2 bg-pink-300 rounded-full"></div> Ë≥ºÁâ©: ¬•{expenseStats.stats.trade.toLocaleString()}</div>
                        <div className="flex items-center gap-1"><div className="w-2 h-2 bg-slate-500 rounded-full"></div> ÂÖ∂‰ªñ: ¬•{expenseStats.stats.other.toLocaleString()}</div>
                    </div>

                    <div className={`bg-slate-800 border-2 ${editingId ? 'border-green-500' : 'border-slate-700'} p-3 mb-6 rounded-sm transition-colors duration-300`}>
                        <div className="flex justify-between items-center mb-2">
                            <h3 className={`text-xs font-bold ${editingId ? 'text-green-400' : 'text-slate-400'} uppercase`}>
                                {editingId ? "‰øÆÊîπ‰∫§ÊòìÁ¥ÄÈåÑ" : "Êñ∞Â¢û‰∫§ÊòìÁ¥ÄÈåÑ"}
                            </h3>
                            {editingId && (
                                <button onClick={handleCancelEdit} className="text-[10px] text-red-400 hover:underline">
                                    ÂèñÊ∂à
                                </button>
                            )}
                        </div>
                        
                        <div className="flex gap-2 mb-2 overflow-x-auto pb-1 no-scrollbar">
                            {EXPENSE_TYPES.map(t => (
                                <button
                                    key={t.id}
                                    onClick={() => setNewExpenseType(t.id)}
                                    className={`px-3 py-1 text-[10px] rounded-full border ${newExpenseType === t.id ? `${t.color} ${t.border}` : 'bg-slate-900 border-slate-700 text-slate-500'}`}
                                >
                                    {t.label}
                                </button>
                            ))}
                        </div>

                        <div className="flex items-center gap-2 mb-2 bg-slate-900 border border-slate-600 rounded p-2">
                            <Calendar className="w-4 h-4 text-slate-400" />
                            <input 
                                type="date" 
                                value={newExpenseDate} 
                                onChange={(e) => setNewExpenseDate(e.target.value)}
                                className="bg-transparent text-xs text-white outline-none w-full font-mono uppercase"
                            />
                        </div>

                        <div className="flex gap-2 mb-2">
                        <input 
                            type="text" placeholder="ÈÅìÂÖ∑ÂêçÁ®±" 
                            value={newExpenseName} onChange={(e) => setNewExpenseName(e.target.value)}
                            className="flex-1 bg-slate-900 border border-slate-600 p-2 text-xs text-white rounded focus:border-yellow-500 outline-none"
                        />
                        <input 
                            type="number" placeholder="¬•" 
                            value={newExpenseCost} onChange={(e) => setNewExpenseCost(e.target.value)}
                            className="w-20 bg-slate-900 border border-slate-600 p-2 text-xs text-white rounded focus:border-yellow-500 outline-none"
                        />
                        </div>
                        
                        <button 
                            onClick={addOrUpdateExpense} 
                            className={`w-full ${editingId ? 'bg-green-900/50 border-green-600 text-green-500 hover:bg-green-900' : 'bg-yellow-900/50 border-yellow-600 text-yellow-500 hover:bg-yellow-900'} border py-2 text-xs font-bold transition flex items-center justify-center gap-2 rounded`}
                        >
                        {editingId ? <RefreshCw size={14} /> : <PlusCircle size={14} />} 
                        {editingId ? "UPDATE LOG" : "ADD TO LOG"}
                        </button>
                    </div>

                    <div className="space-y-2">
                        {expenses.sort((a,b) => new Date(b.date) - new Date(a.date)).map((exp) => (
                        <div key={exp.id} className={`flex flex-col p-3 bg-slate-800/50 border-b ${editingId === exp.id ? 'border-green-500 bg-green-900/10' : 'border-slate-700'}`}>
                            <div className="flex justify-between items-center mb-1">
                                <div className="flex items-center gap-2">
                                    <div className={`w-2 h-2 rounded-full ${
                                        exp.type === 'travel' ? 'bg-blue-500' :
                                        exp.type === 'save' ? 'bg-green-500' :
                                        exp.type === 'loot' ? 'bg-yellow-500' :
                                        exp.type === 'trade' ? 'bg-pink-300' : 
                                        'bg-slate-500'
                                    }`}></div>
                                    <span className="text-sm font-bold">{exp.item}</span>
                                </div>
                                <div className="flex items-center gap-2">
                                    <span className={`text-sm font-mono ${exp.cost > 0 ? 'text-red-300' : 'text-green-300'}`}>
                                        {exp.cost > 0 ? '-' : '+'}¬•{Math.abs(exp.cost).toLocaleString()}
                                    </span>
                                    <button onClick={() => handleEdit(exp)} className="text-slate-500 hover:text-green-400 p-1"><Edit size={12} /></button>
                                    <button onClick={() => handleDelete(exp.id)} className="text-slate-500 hover:text-red-400 p-1"><Trash2 size={12} /></button>
                                </div>
                            </div>
                            <div className="text-[10px] text-slate-500 flex items-center gap-1 font-mono">
                                <Calendar size={10} /> {exp.date}
                            </div>
                        </div>
                        ))}
                    </div>

                    <div className="fixed bottom-[72px] left-0 right-0 max-w-md mx-auto bg-slate-900/95 backdrop-blur border-t-2 border-slate-700 p-3 shadow-lg z-10 flex justify-between items-center">
                        <div className="text-[10px] text-slate-400">
                            <div>RATE: {exchangeRate}</div>
                            <div>NTD EST.</div>
                        </div>
                        <div className="text-xl font-mono text-slate-300 font-bold">
                            ‚âà ${totalSpentTWD.toLocaleString()}
                        </div>
                    </div>
                </div>
            );

            const GrimoireView = () => (
                <div className="w-full animate-enter pb-20">
                <div className="bg-slate-800 border-2 border-blue-500 p-4 rounded-sm mb-6 relative overflow-hidden shadow-[0_0_15px_rgba(59,130,246,0.2)]">
                    <div className="absolute top-0 right-0 bg-blue-600 text-[10px] px-2 py-0.5 text-white font-bold font-mono">LIVE TRANSLATE</div>
                    <div className="flex items-center gap-2 mb-3">
                        <Globe className="text-blue-400" size={20} />
                        <h3 className="font-bold text-blue-300">ÈÄöÁî®Ë™ûÁøªË≠ØË°ì</h3>
                    </div>
                    <div className="flex gap-2">
                        <input 
                            type="text" 
                            placeholder="Ëº∏ÂÖ•‰∏≠ÊñáÂííË™û..." 
                            value={transInput}
                            onChange={(e) => setTransInput(e.target.value)}
                            className="flex-1 bg-slate-900 border border-slate-600 p-2 text-sm text-white rounded outline-none focus:border-blue-400 placeholder:text-slate-600"
                        />
                        <button 
                        onClick={handleTranslate} 
                        disabled={isTranslating}
                        className="bg-blue-600 hover:bg-blue-500 disabled:bg-blue-800 disabled:text-gray-400 text-white px-4 rounded font-bold text-xs transition flex items-center gap-1 whitespace-nowrap"
                        >
                            {isTranslating ? <Loader2 className="animate-spin" size={14} /> : "Ë©†Âî±"}
                        </button>
                    </div>
                    {transResult && (
                    <div className="mt-3 p-3 bg-slate-900 border border-blue-500/50 rounded animate-enter flex justify-between items-start">
                        <div>
                            <div className="text-[10px] text-blue-400 mb-1 font-bold font-mono">RESULT</div>
                            <div className="text-lg text-white font-bold leading-relaxed">{transResult}</div>
                        </div>
                        <button onClick={() => speakJapanese(transResult)} className="text-blue-400 hover:text-white p-2">
                            <Volume2 size={20} />
                        </button>
                    </div>
                    )}
                </div>
                <div className="text-center mb-4 flex items-center justify-center gap-2 opacity-80">
                    <div className="h-[1px] bg-slate-700 w-10"></div>
                    <h2 className="text-sm font-bold text-purple-400">Â∏∏Áî®Ê∫ùÈÄöÂç°Áâå</h2>
                    <div className="h-[1px] bg-slate-700 w-10"></div>
                </div>
                <div className="grid grid-cols-2 gap-3">
                    {SPELL_DATA.map((spell, idx) => (
                    <div 
                        key={idx} 
                        onClick={() => setSelectedSpell(spell)}
                        className="bg-slate-800 border border-slate-600 p-3 rounded hover:border-purple-500 transition group cursor-pointer relative overflow-hidden flex flex-col items-center text-center shadow-md active:scale-[0.98]"
                    >
                        <div className="text-3xl mb-2 group-hover:scale-110 transition-transform">{spell.icon}</div>
                        <div className="font-bold text-purple-300 text-sm mb-1">{spell.title}</div>
                        <div className="text-[10px] text-slate-500">{spell.zh}</div>
                        <div className="absolute top-2 right-2 text-slate-500 hover:text-white" onClick={(e) => { e.stopPropagation(); speakJapanese(spell.jp); }}>
                            <Volume2 size={16} />
                        </div>
                    </div>
                    ))}
                </div>
                {selectedSpell && (
                    <div className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/90 backdrop-blur-sm animate-enter" onClick={() => setSelectedSpell(null)}>
                        <div className="bg-slate-900 border-4 border-purple-500 p-6 rounded-lg max-w-sm w-full relative shadow-[0_0_50px_rgba(168,85,247,0.5)] flex flex-col items-center" onClick={e => e.stopPropagation()}>
                            <button onClick={() => setSelectedSpell(null)} className="absolute top-2 right-2 text-slate-400 hover:text-white p-2">
                                <X size={24} />
                            </button>
                            <div className="text-8xl mb-6 animate-bounce">{selectedSpell.icon}</div>
                            <div className="text-2xl font-bold text-purple-300 mb-6 border-b-2 border-purple-800 pb-2 w-full text-center">{selectedSpell.title}</div>
                            <div className="bg-white text-black p-6 rounded-lg mb-4 shadow-inner w-full flex justify-between items-center">
                                <div className="text-2xl font-black leading-snug text-center flex-1">{selectedSpell.jp}</div>
                                <button onClick={() => speakJapanese(selectedSpell.jp)} className="ml-2 text-purple-600 p-2 bg-purple-100 rounded-full hover:bg-purple-200">
                                    <Volume2 size={24} />
                                </button>
                            </div>
                            <div className="text-lg text-slate-400">{selectedSpell.zh}</div>
                            <div className="mt-8 text-[10px] text-purple-500 font-mono tracking-[0.2em] animate-pulse">SPELL CARD ACTIVE</div>
                        </div>
                    </div>
                )}
                </div>
            );

            const InfoView = () => (
                <div className="w-full animate-enter pb-20 space-y-6">
                    <div className="grid grid-cols-2 gap-3">
                        <a href="https://www.jma.go.jp/bosai/forecast/" target="_blank" className="bg-slate-800 p-4 rounded border border-slate-600 flex flex-col items-center justify-center hover:bg-slate-700 transition gap-2">
                            <Cloud className="text-blue-400" />
                            <span className="text-xs font-bold text-blue-100">Êó•Êú¨Ê∞£Ë±°Âª≥</span>
                        </a>
                        <div className="bg-slate-800 p-4 rounded border border-slate-600 flex flex-col items-center justify-center gap-1 relative group overflow-hidden">
                            <div className="flex items-center gap-2 text-yellow-400 mb-1">
                                <Coins size={18} />
                                <span className="text-xs font-bold text-yellow-100">ÂåØÁéáÂèÉËÄÉ (JPY)</span>
                            </div>
                            <div className="text-2xl font-mono font-bold text-white tracking-wider">{exchangeRate}</div>
                            <div className="text-[10px] text-slate-500 font-mono">1 JPY ‚âà {exchangeRate} TWD</div>
                            <RefreshCw size={12} className="absolute top-2 right-2 text-slate-600 hover:text-white transition-colors cursor-pointer" onClick={() => fetchRate()} />
                        </div>
                    </div>
                    {/* ... (Emergency and other info sections same as before) ... */}
                    <div className="bg-red-900/20 border-2 border-red-500/50 p-4 rounded-sm relative overflow-hidden">
                         <div className="absolute top-0 right-0 bg-red-600 text-[10px] px-2 py-0.5 text-white font-bold font-mono">EMERGENCY</div>
                        <h3 className="font-bold text-red-400 mb-4 flex items-center gap-2">
                            <Siren className="w-5 h-5 animate-pulse" /> Á∑äÊÄ•ËÅØÁµ°
                        </h3>
                        <div className="space-y-3">
                            <div className="flex items-center justify-between bg-black/40 p-2 rounded border border-red-900/50">
                                <span className="text-sm font-bold text-white flex items-center gap-2"><Phone size={14}/> Ë≠¶ÂØüÂ±Ä</span>
                                <span className="text-xl font-mono text-red-400 font-bold">110</span>
                            </div>
                            <div className="flex items-center justify-between bg-black/40 p-2 rounded border border-red-900/50">
                                <span className="text-sm font-bold text-white flex items-center gap-2"><PlusCircle size={14}/> ÊïëË≠∑/ÁÅ´Ë≠¶</span>
                                <span className="text-xl font-mono text-red-400 font-bold">119</span>
                            </div>
                            <div className="mt-2 text-xs text-slate-400 p-2 border-t border-red-900/30">
                                <div className="font-bold text-red-300 mb-1">Âè∞ÂåóÈßêÊó•Á∂ìÊøüÊñáÂåñ‰ª£Ë°®Ëôï (Á∑äÊÄ•)</div>
                                <div className="font-mono selectable select-all">+81-80-1009-7179</div>
                                <div className="text-[10px] opacity-70 mt-1">‚ÄªÂÉÖÈôêÊÄ•Èõ£ÊïëÂä©‰ΩøÁî® (ËªäÁ¶ç„ÄÅË≠∑ÁÖßÈÅ∫Â§±Á≠â)</div>
                            </div>
                        </div>
                    </div>
                    <div className="bg-slate-800 border border-yellow-600/30 p-4 rounded-sm">
                        <h3 className="font-bold text-yellow-500 mb-3 flex items-center gap-2">
                            <AlertTriangle className="w-4 h-4" /> ÂÜíÈö™È†àÁü• (Taboos)
                        </h3>
                        <ul className="text-xs text-slate-300 space-y-2 list-disc list-inside opacity-90">
                            <li><strong className="text-yellow-200">Âà∫ÈùíÔºö</strong>Â§ßÈÉ®ÂàÜÊ∫´Ê≥â/Â§ßÁúæÊæ°Â†ÇÁ¶ÅÊ≠¢ÈÄ≤ÂÖ•„ÄÇ</li>
                            <li><strong className="text-yellow-200">ÈõªËªäÔºö</strong>ËªäÂªÇÂÖßÁ¶ÅÊ≠¢Ë¨õÈõªË©±ÔºåË´ãÈñãÈùúÈü≥Ê®°Âºè„ÄÇ</li>
                            <li><strong className="text-yellow-200">ÊãçÁÖßÔºö</strong>Êú™Á∂ìÂÖÅË®±Ë´ãÂãøÁõ¥Êé•ÊãçÊîùË∑Ø‰∫∫ÊàñÂ∫óÂì°„ÄÇ</li>
                            <li><strong className="text-yellow-200">ÁµêÂ∏≥Ôºö</strong>Ë´ãÂ∞áÈå¢ÊîæÂú®Ê´ÉÂè∞ÁöÑÂ∞èÁõ§Â≠ê(Cash Tray)‰∏ä„ÄÇ</li>
                            <li><strong className="text-yellow-200">ÂÖ•Â¢ÉÔºö</strong>ËÇâÈ°ûË£ΩÂìÅ(Âê´ËÇâ‰πæ)„ÄÅÁîüÈÆÆÊ∞¥ÊûúÂö¥Á¶ÅÊîúÂ∏∂„ÄÇ</li>
                        </ul>
                    </div>
                    <div className="bg-slate-800 border border-slate-600 p-4 rounded-sm">
                        <div className="flex justify-between items-center mb-3">
                            <h3 className="font-bold text-slate-300 flex items-center gap-2">
                                <Shield className="w-4 h-4 text-blue-400" /> Ë£ùÂÇôÊ™¢Êü•
                            </h3>
                            <button onClick={() => setChecklist(INITIAL_CHECKLIST)} className="text-[10px] text-slate-500 hover:text-white underline">ÈáçÁΩÆ</button>
                        </div>
                        <div className="space-y-2">
                        {checklist.map((item) => (
                            <div 
                            key={item.id} 
                            onClick={() => toggleCheck(item.id)}
                            className={`flex items-center gap-3 p-3 rounded cursor-pointer border hover:bg-slate-700 transition select-none ${item.checked ? 'bg-green-900/20 border-green-900 opacity-60' : 'bg-slate-900 border-slate-700'}`}
                            >
                            <div className={`w-5 h-5 border-2 flex-shrink-0 flex items-center justify-center rounded-sm transition-colors ${item.checked ? 'bg-green-600 border-green-600' : 'border-slate-500'}`}>
                                {item.checked && <CheckSquare className="w-3 h-3 text-white" />}
                            </div>
                            <span className={`text-sm ${item.checked ? 'line-through text-slate-500' : 'text-slate-200'}`}>{item.text}</span>
                            </div>
                        ))}
                        </div>
                    </div>
                    <div className="bg-slate-900/50 border border-slate-700 p-3 rounded flex items-start gap-3">
                        <Shirt className="w-5 h-5 text-blue-400 mt-1 flex-shrink-0" />
                        <div>
                            <div className="text-xs text-blue-400 font-bold mb-1 font-mono">OUTFIT ADVICE ({weatherTemp}¬∞C)</div>
                            <div className="text-sm text-slate-300">{getOutfitAdvice(weatherTemp)}</div>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen pb-20 max-w-md mx-auto shadow-2xl border-x border-slate-800 bg-slate-900 relative">
                
                <div className="w-full mb-6 border-b border-slate-800 pb-4 text-center sticky top-0 bg-slate-900/95 backdrop-blur z-20 pt-4 px-4 shadow-lg">
                    <h1 className="text-xl font-bold tracking-widest text-yellow-400 mb-2 uppercase drop-shadow-[0_2px_10px_rgba(250,204,21,0.2)] flex items-center justify-center gap-2">
                        <MapPin size={18} /> ÂêçÂè§Â±ãÂÜíÈö™Êó•Ë™å
                    </h1>
                    <div className="text-[10px] text-slate-400 flex justify-center gap-4 uppercase tracking-wider font-mono">
                    <span className="flex items-center gap-1"><Shield className="w-3 h-3" /> LV.5 Traveler</span>
                    </div>
                </div>

                <div className="px-4">
                    {activeTab === 'quest' && <QuestView />}
                    {activeTab === 'inventory' && <InventoryView />}
                    {activeTab === 'grimoire' && <GrimoireView />}
                    {activeTab === 'info' && <InfoView />}
                </div>

                <div className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-slate-900 border-t border-slate-700 p-2 z-30 pb-safe">
                    <div className="grid grid-cols-4 gap-1">
                    <button onClick={() => setActiveTab('quest')} className={`flex flex-col items-center justify-center p-2 rounded transition-all duration-300 ${activeTab === 'quest' ? 'text-yellow-400 bg-slate-800' : 'text-slate-500 hover:text-slate-300'}`}>
                        <Scroll className={`w-5 h-5 mb-1 ${activeTab === 'quest' ? 'drop-shadow-[0_0_5px_rgba(250,204,21,0.5)]' : ''}`} />
                        <span className="text-[10px] font-bold">‰ªªÂãô</span>
                    </button>
                    <button onClick={() => setActiveTab('inventory')} className={`flex flex-col items-center justify-center p-2 rounded transition-all duration-300 ${activeTab === 'inventory' ? 'text-yellow-400 bg-slate-800' : 'text-slate-500 hover:text-slate-300'}`}>
                        <Coins className={`w-5 h-5 mb-1 ${activeTab === 'inventory' ? 'drop-shadow-[0_0_5px_rgba(250,204,21,0.5)]' : ''}`} />
                        <span className="text-[10px] font-bold">Ë°åÂõä</span>
                    </button>
                    <button onClick={() => setActiveTab('grimoire')} className={`flex flex-col items-center justify-center p-2 rounded transition-all duration-300 ${activeTab === 'grimoire' ? 'text-yellow-400 bg-slate-800' : 'text-slate-500 hover:text-slate-300'}`}>
                        <BookOpen className={`w-5 h-5 mb-1 ${activeTab === 'grimoire' ? 'drop-shadow-[0_0_5px_rgba(250,204,21,0.5)]' : ''}`} />
                        <span className="text-[10px] font-bold">È≠îÂ∞éÊõ∏</span>
                    </button>
                    <button onClick={() => setActiveTab('info')} className={`flex flex-col items-center justify-center p-2 rounded transition-all duration-300 ${activeTab === 'info' ? 'text-yellow-400 bg-slate-800' : 'text-slate-500 hover:text-slate-300'}`}>
                        <Info className={`w-5 h-5 mb-1 ${activeTab === 'info' ? 'drop-shadow-[0_0_5px_rgba(250,204,21,0.5)]' : ''}`} />
                        <span className="text-[10px] font-bold">Ë≥áË®ä</span>
                    </button>
                    </div>
                </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>